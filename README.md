` `به نام خدا

![](Aspose.Words.818ada1f-435d-4835-91ed-4134617ad03c.001.png)

` `ناهید ازادی چگنی

` `شماره دانشجوی: 40211415002

` `استاد : دکتر ارمین  رشنو
موضوع : تمرین کلاسی پردازش موازی  

اولین مرحله اومدم یه فایل درست کردم به اسم config که تمام صفحه هامو داخلش import کردم و یه فایل main دارم که نقطه ی اتصال رو اونجا قرار دادم .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.002.jpeg)

`  `config فایل

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.003.jpeg)

`  `main فایل 

` `در این مرحله یکی یکی تمرین هارو قرار می دهیم .  

`  `هاthread

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.004.png)

این تمرین اول ما می باشد که ما باید خروجی جیسون را ایجاد کنیم براش و یکی یکی سناریو ها رو قرار میدهم.  سناریو اول:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.005.jpeg)

توی این مرحله اومدم ایمپورت های که نیاز هست رو انجام دادم و یک کلاس basemodel هم براش ایجاد کردم.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.006.jpeg)

توی این سناریو خروجی مورد نظری که توی تمرین ازمون خواسته بود رو ایجاد کردم با خروجی جیسون که توی این کد یه حلقه قرار دادم  که توی رنج 10 تا اجرا میشه داخل این حلقه یک شی ایجاد کردم از کلاس ترد که یک تارگت و یک 

ارگمان می گیرد که تارگت my\_func\_wrapper می باشد که خروجی های مورد نظر ما رو به یک لیست اضافه میکند 

که چاپ بشن.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.007.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.008.png)

سناریو دوم :  

توی این سنارو گفتم اول فرد هارو برام نمایش بده بعد زوج هارو که خروجی متفاوت برای ما تولید بشه  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.009.jpeg)

`  `ایجاد میکند تا پیامهای تولید شده توسط هر رشته را ذخیره کندoutputs  این خط یک لیست خالی به نام  : outputs = []   :def my\_func\_wrapper(thread\_number)

این تابع کمکی شما هی رشته را به عنوان آرگومان میگیرد، سپس  my\_funcرا با شماره رشته فراخوانی میکند تا یک پیام تولید شود. اگر شماره رشته زوج باشد، پیام به انتهای لیست  outputs اضافه میشود، در غیر این صورت، پیام به ابتدای لیست اضافه میشود.  

`  `:for توی حلقه ی

این قسمت کد هم ، 10 رشته ایجاد میکند و هر کدام از آنها تابع  my\_func\_wrapper را با شماره رشته مربوطه فراخوانی میکند. سپس هر رشته شروع به کار میکند.  

توی قسمت for پاینی :این حلقه منتظر میماند تا همهی رشتهها کار خود را به پایان برسانند  

- را که شامل پیامهای تولید شده توسط رشتهها است، برمیگرداند outputs این خط لیست :return outputs

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.010.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.011.png)

سناریو سوم :  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.012.jpeg)

توی این سناریو هم توضیحات مثل سناریو های قبلی می باشد فقط اومدم جلوی حلقه  for بهش گفتم که معکوس رو برام انجام بده یعنی برعکس کنه رشته هارو که خروجی متفادت تولید بشه برام .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.013.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.014.png)

**تمرین دوم :**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.015.png)

.

سناریو اول:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.016.jpeg)

توی این عکس ما برای هر تابع یک لیست درست کردم که وضعیت اجراش توی اون ذخیره بشه بعد اومدم تابع هارو تعریف کردم که توی این توابع عملکردشون رو توی اون لیست ذخیره می کنند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.017.jpeg)

توی این هم اومدم رشته هارو درست کردم که استارت و جوین می شوند به ترتیب خواسته شده .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.018.jpeg)

function\_A, قرار دارد. این قطعه کد بخشی از تابعی است که نتایج خروجی سه تابع return  توی این قسمت اومدم جای که  برمیگرداند. هر یک از این توابع در رشتههای جداگانه (dictionary) را در یک دیکشنریfunction\_c   وfunction\_B, 

اجرا میشوند و وضعیت خود را در لیستهای سراسری (output\_A, output\_B, output\_C) ذخیره میکنند. سپس این دیکشنری به عنوان پاسخ HTTP به کلاینت بازگردانده میشود. که اونای که مقار صفر دارن یعنی خروجی اولی  و اونای که مقدار 

یک دارن یعنی خروجی دومی.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.019.png)

سناریو **دوم** و **سوم** هم مثل هون اولی می باشد ترتیب استارت و جوین ها رو تغیر داده ایم .که خروجی متفاوت تولید شود  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.020.png)

خروجی سناریو دوم  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.021.png)

خروجی سناریو سوم  

.

تمرین سوم:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.022.jpeg)

سناریو اول:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.023.jpeg)

توی این مرحله اومدم یک کلاس ThreadOutput درست کردم که یک مدل ساده می باشد که فیلد  message از نوع رشته    (string)است که برای نگهداری پیامهای تولید شده توسط رشتهها استفاده میشود را در خود دارد.  

و یک کلاس mythred هم دارم که از threading.Thread ارث بری میکنه و دو مقدار هم داره  :**\_\_init\_\_**برای مقداردهی اولیه نام رشته و لیستی که پیامها در آن ذخیره میشوند. و  **run** برای اجرای عملیات اصلی رشته که شامل افزودن پیام شروع، 

انتظار به مدت 1 ثانیه و افزودن پیام پایان است استفاده میشود .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.024.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.025.jpeg)

توی این دوتا عکس هم اومدم رشته هارو ایجاد کردم نام رو هم به اونا اختصاص دادم  دوتا حلقه گذاشتم برای استارت و جوین شدن هر کدام و قسمت پاینی اون این بخش از کد مدت زمان کل اجرای رشتهها را محاسبه کرده و آن را به عنوان یک پیام به لیست 

خروجی اضافه میکند. این کار به شما امکان میدهد که بدانید اجرای تمامی رشتهها چقدر زمان برده است همان پیغام پایانی توی  خروجی می باشد.

` `توی سناریو اول من خروجی رو مطابق با اون چیزی که خواسته شده درست کردم 

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.026.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.027.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.028.png)

` `**سناریو دوم:**

توی این سناریو اومدم پیام استارت و پایان رو برای هر رشته زیر هم قرار دادم یعنی استارت میشه پیام راچاپ میکنه و تمام میشه  پیام پایان رو چاپ میکنه توی این رشته ها از کوچک به بزرگ پیام های آن ها چاپ میشه.

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.029.jpeg)

` `گفتم بهش رشته رو که گرفتی استارت شد جوین رو هم پشت سرش انجام بده .

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.030.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.031.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.032.png)

` `**سناریو سوم:**

توی این سناریو بهش گفتم به صورت نزولی پیام های مربوط به استارت و پایان اون هارو نمایش بهم بده یعنی اول رشته 9 اجرا و  پایان یعد رشته 8 اجرا و پایان به همین صورت.

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.033.jpeg)

` `که خروجی مورد نظر را قرار میدهیم.

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.034.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.035.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.036.png)

` `**تمرین چهارم:**

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.037.png)

` `**سناریو اول :**

` `توی این سناریو بهش گفتم از داخلی ترین ترد شروع کنه و یکی از پایین چاپ میکنه یکی از بالا به همین صورت .

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.038.jpeg)

اول اومدم یه کلاس ThreadOutput درست کردم که این کلاس یک مدل ساده با دو فیلد   thread\_number شماره رشته و      

- پیام است که برای نگهداری پیامهای تولید شده توسط رشتهها استفاده میشودmessage
- init,run ارث بری میکنه و دو متد دارهthreading.Thread که این کلاس از MyThread یک کلاس هم درست کردم به اسم

که  init برای  مقداردهی اولیه نام رشته، شماره رشته، لاک (lock) و لیستی که پیامها در آن ذخیره میشوند استفاده میشه .  

و run هم برای  اجرای عملیات اصلی رشته که شامل افزودن پیام شروع، انتظار به مدت 1ثانیه، و افزودن پیام پایان است. از لاک برای اطمینان از اجرای همزمان امن استفاده میکند.که در این تابع لاک قفل را میگیرد و پیام هارو چاپ میکنه بعد ازاد میکنه قفل 

رو .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.039.jpeg)

- استفاده میشه (threads) این لیست برای نگهداری پیامهای تولید شده توسط رشتهها  : output\_list = []

` `ایجاد می شه تا دسترسی به منابع مشترک در اینجا (concurrency) یک لاک برای کنترل همزمانی : lock = threading.Lock()

- به صورت ایمن انجام بشهoutput\_list
- زمان شروع اجرای رشتهها ثبت میشه تا در نهایت مدت زمان کل اجرای رشتهها محاسبه بشه : start\_time = time.time()
- threads = [ MyThread(f"Thread#{i+1}", i+1, lock, output\_list) for i in range(9)]

یک لیست شامل 9 رشته از نوع  MyThread ایجاد میشه. هر رشته با نام منحصربهفرد (... ,Thread#1, Thread#2) و شمارهی مربوطه (i+1) مقداردهی اولیه میشود. همچنین هر رشته به لاک (lock) و لیست خروجی (output\_list) دسترسی 

داره.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.040.jpeg)

این بخش از کد مسئول مرتبسازی رشتهها(threads)  به گونهای است که ابتدا از مرکز لیست شروع کرده و به صورت متناوب به چپ و راست حرکت میکند. این کار باعث میشود که رشتهها به صورت متوازنتر و با فاصلهی زمانی مناسبتری اجرا شوند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.041.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.042.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.043.png)

**سناریو دوم :**  

توی این سناریو هم میاد از کوچیک به بزرگ ترد ها یا رشته ها رو چاپ میکنه . توضیحات مثل قبلی است دیگه از تو ضیحات اضافه اجتناب میشه.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.044.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.045.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.046.jpeg)

خروجی کد:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.047.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.048.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.049.png)

**سناریو سوم** : توی این سناریو هم گفتم به صورت نزولی بیاد چاپ کند خروجی هارو .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.050.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.051.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.052.jpeg)

در قسمت output\_list.sort اومدم مقدار لیست را برعکس کرده ایم  خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.053.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.054.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.055.png)

**تمرین پنجم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.056.jpeg)

**سناریو اول :**  

توی این سناریو من اومدم خروجی مورد نظر که ازم خواسته بود رو تولید کرده ام .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.057.jpeg)

ما یک کلاس box درست کردیم که 4 تا تابع رو توی خودش داره که به شرح هر کدوم می پردازیم.  

`  `:init تابع  یک نوع خاص از قفلها است که به یک. RLock ایجاد میشود (threading.RLock) قفل مجددپذیر  self.lock

رشته این امکان را میدهد که قفل را چندین بار بگیرد.  

- که مقدار اولیه آن 0 هستش Box  شمارندهای برای نگهداری تعداد اقلام در  self.total\_items
- executeتابع

` `هیچ رشته دیگری ،total\_items اطمینان حاصل میکنه که هنگام اجرای تغییرات بر روی  with self.lock

نمیتونه به این بخش از کد دسترسی پیدا کنه، چون قفل گرفته شده .  

` `مثبت value   تغییر میکنه. اگر value   بر اساس total\_items   مقدار  self.total\_items += value

باشه،  total\_items افزایش پیدا میکنه و اگر منفی باشه، کاهش پیدا میکنه.  

`  `:add تابع

`  `این متد برای افزودن یک واحد به   total\_items استفاده میشه  

` `اطمینان حاصل میکند که تنها یک رشته در هر زمان میتواند به این بخش ،execute همانند متد with self.lock

از کد دسترسی داشته باشه    

`  `:remove متد 

`  `این متد برای کاهش یک واحد از  total\_items استفاده میشه.  

- اطمینان حاصل میکنه که تغییرات به صورت ایمن و همزمان انجام بشه ،add همانند متد  with self.lock: 

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.058.jpeg)

- لیستی برای نگهداری نتایج و پیامهای مربوط به عملیات   ذخیره میشه  Results[]   قفلی برای هماهنگی بین رشتهها  یا ترد ها : lock
- باید شروع شود یا نه (removing) برای نشان دادن اینکه آیا عملیات حذف (flag) یک فلگ remove\_started  استفادهremove\_started  وresults  این خط به پایتون مگوید که از متغیرهای :nonlocal results, remove\_started

کند که در سطح بیرونیتر تعریف شدهاند.  

` `در کد به معنای استخراج تعداد آیتمهایی است که باید به جعبه اضافه شوند همان ایتم های که از بدنه : items = request.items

تو اینسمنیا بهش می فرستم.  

`  `پیام شروع عملیات افزودن به لیست نتایج اضافه میشود :results.append(f"N° {items} items to ADD)

حلقه   while تا زمانی که   items بزرگتر از 0 باشد اجرا میشود:  

- یک آیتم به جعبه اضافه میکند :   box.add()
  - یک ثانیه صبر میکند : time.sleep(1)
- تعداد آیتمهای باقیمانده برای افزودن را کاهش میدهد :  items -= 1  پیام افزودن یک آیتم به :results.append(f"ADDED one item -->{items} item(s) to ADD")

لیست نتایج اضافه میشود.  

با استفاده از قفل، بررسی میکند که آیا عملیات حذف باید شروع شود:  

یک حلقه قرار داده شده که اگر مقدار box.total\_items > 0 باشد حذف کردن ترو می شود و شروع به کار میکند.

· 

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.059.jpeg)

این کد تابعی به نام   remover را تعریف میکند که مسئول حذف اقلام از جعبه (Box) به صورت همزمان ب سایر رشتهها 

- است. این تابع از قفل استفاده میکند تا اطمینان حاصل شود که عملیات حذف به صورت ایمن انجام میشود(threads) 
  - نشان دهنده تعداد ایتم های است که باید حذف شوند :items = 1 

بعد پیامی چاپ می شود بعد از آن یه حلقه قرار داده شده که  اگر مقدار بزرگتر از صفر بود ان را حذف کند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.060.jpeg)

{return {"status": "success", "results": results: این خط کد، تابع   start\_operations را به پایان میرساند و نتیجهی عملیات را به عنوان پاسخ به کلاینت برمیگرداند. در واقع، این خط یک شیء دیکشنری شامل وضعیت و نتایج عملیات را بازمیگرداند.  

` `خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.061.png)

**سناریو دوم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.062.jpeg)

- استفاده میشه post  این تابع برای پردازش این درخواست :def start\_operations(request: OperationRequest)** 
- برای اعتبارسنجی ورودیها است Pydantic است که یک مدلOperationRequest  از نوع  :request
  - یک لیست خالی که برای ذخیره پیامهای خروجی استفاده میشود :  results

` `تعداد آیتمهایی که باید اضافه شوند، از درخواست استخراج میشود  همون ورودی که بهش دادم :  items\_to\_add

هر چند تای که بود.  

`  `این تابع یک حلقه دارد که از  items\_to\_add تا 0 شمارش میکند  .در هر تکرار، یک آیتم به جعبه اضافه میشود.  

- remov تلبع

این تابع یک حلقه دارد که از 0 تا   items\_to\_add شمارش میکند  .در هر تکرار، یک آیتم از جعبه حذف میشود.  یک پیام به  results اضافه میشود که نشان میدهد چند آیتم باقی مانده است تا حذف شوند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.063.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.064.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.065.png)

**سناریو سوم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.066.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.067.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.068.png)

**تمرین ششم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.069.jpeg)

**سناریو اول:توی این سناریو دقیقا همه خروجی تولید میشه تولید کننده تولید میکنه مصرف کننده مصرف میکنه .**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.070.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.071.jpeg)

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.072.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.073.png)

**سناریو دوم:**  

**توی این سناریو اومدم جوین هارو برداشتم تا عملکرد کد رو تست کنم که توی این سناریو فقط مصرف کننده چاپ میشه و به حالت انتضار می رود.**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.074.png)

**تمرین هفتم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.075.png)

`  `**سناریو اول:**  

این کد یک شبیهسازی ساده از یک مسابقه با سه دونده را انجم میدهد. در این مسابقه، دوندگان با تأخیر مشخصی شروع به حرکت میکنند و در نهایت همگی به یک نقطه (خط پایان) میرسند و منتظر میمانند تا همه دوندگان دیگر نیز برسند. سپس 

نتایج ثبت و چاپ میشوند.

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.076.jpeg)

تعریف تعداد دوندگان و ایجاد یک  Barrierبرای هماهنگسازی و تعریف لیست دوندگان و تعریف ایست نتایج .  

این تابع  runner در کد  وظیفه شبیهسازی رفتار یک دونده در مسابقه را بر عهده دارد. به طور دقیقتر، این تابع هر دونده را با نام و تأخیر مشخصی مدلسازی میکند و سپس رفتار او را هنگام رسیدن به خط پایان ثبت میکند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.077.jpeg)

این قسمت لیست دوندگان، لیست نتایج و  Barrierرا برای هر مسابقه تنظیم مجدد میکنداین توضیحات مال خط های کالا حلقه است.  

توی قسمت if تاخیر های برا سه شرکت کننده تعریف شده است مثلا یکی یک ثانیه یکی دو ثانیه یکی سه ثانیه به همین صورت ما می توانیم به جای این تاخیر های ثابت تاخیر رندم هم قرار دهیم ما اینجا گفته ایم اگر تعداد 3 تا بود از تاخیر های که به 

صورت ثابت گذاشتم استفاده کن اگر نبود از رندم استفاده کن .  

یک لیست خالی ایجاد میشه و پیام استارت رو چاپ میکنه.  

**عملکرد** :حلقه   for برای هر دونده تعداد دوندگان معادل   num\_runners تکرار میشود  

.

**انتخاب نام دونده** :از   (runners.pop(0 برای انتخاب و حذف اولین نام از لیست  runners استفاده میشود. این به این معنی است که نام اولین دونده از لیست گرفته میشود و بلافاصله از لیست حذف میشود.  

**ایجاد نخ** :برای هر دونده، یک شیء  Thread ایجاد میشود:  

target=runner تابع  runner به عنوان تابعی که نخ اجرا خواهد کرد، مشخص میشود.  

([args=(name, delays[i پارامترهای  name و تأخیر مربوطه از لیست   delays به عنوان آرگومانها به تابع   runner منتقل میشود.  

**شروع نخ** ()threads[-1].start :نخ ایجاد شده را شروع میکند 1- .به آخرین نخ اضافه شده اشاره دارد.

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.078.jpeg)

` `خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.079.png)

**سناریو دوم:**من اومدم تو این سناریو لیست نتایج رو بر عکس کردم یعنی اونه که اول شده به عنوان اخرین نفر اسم اون میاد.  

**شبیهسازی مسابقه** :دوندگان با تأخیرهای تصادفی به خط پایان میرسند.  **استفاده از**  **Barrier** برای همگامسازی دوندگان.  

**معکوس کردن نتایج** :ترتیب نتایج به صورت معکوس بازگردانده میشود. به این ترتیب، اگر   Huey به خط پایان زودتر از بقیه رسید، در انتهای لیست نتایج قرار خواهد گرفت.  

این کد به خوبی شبیهسازی را انجام میدهد و با معکوس کردن نتایج، ترتیب رسیدن دوندگان به خط پایان را به نوعی نمایش میدهد که نتایج به شکل معکوس برگردانده شوند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.080.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.081.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.082.jpeg)

جای که نوشته  [result[::-1 اینجا عملیات را معکوس میکنه و اونی که اول هست به اخر لیست اضافه میشه.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.083.png)

**سناریو سوم:  شبیهسازی مسابقه**:  

- این کد شبیهسازی میکند که چندین دونده با تأخیرهای تصادفی در یک مسابقه شرکت میکنند·

` `ترتیب شروع دوندگان تصادفی میشود، که ،random.shuffle(runners) **چیدمان تصادفی** :با استفاده از·

به شبیهسازی طبیعیتری کمک میکند.  

این کد میتواند برا تست یا شبیهسازی سناریوهای مختلف مسابقات مفید باشد، به ویژه زمانی که نیاز به بررسی رفتار در شرایط تصادفی یا مدیریت همزمانی وجود دارد.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.084.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.085.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.086.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.087.png)

`  `Process-Based Parallelism

**سناریو اول :** توی این سناریو خروجی که خواسته شده رو ایجاد کرده ایم مطابق با خروجی تمرین می باشد.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.088.jpeg)

`  `:myFunc تعریف تابع

- شماره پردازش  i
- برای ذخیره خروجیهای تولید شده توسط پردازش output  

**عملکرد**:  

یک رشته (output\_str) ایجاد میکند که شماره پردازش را نشان میدهد.  در یک حلقه تا عدد i، خروجیهایی تولید میکند.  

در نهایت، رشته خروجی را در   output قرار میدهد.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.089.png)

توی این کد ما یک فرایند والد داریم و یک فرایند فرزند که فرایند والد تا 5 تا اجرا میشه و فرایند فرزند تا یکی کتر از والد اجرا میشن.  

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.090.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.091.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.092.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.093.png)

**سناریو دوم:** توی این سناریو تعداد رو از 6 ب  4کاهش دادم که تعداد خروجی کمتر می شود  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.094.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.095.png)

**سناریو سوم:** توی این سناریو اومدم خروجی رو کامل به صورت رندم کردم که هم والد و هم فرزندان کامل رندم شده اند و خروجی رندمی در هر مرحله اجرا نمایش میدهند.  

random.shuffle(results) ![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.096.png)

با استفاده از این خروجی رو رندم کرده ام.  خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.097.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.098.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.099.png)

**تمرین دوم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.100.png)

سناریو اول: توی این سناریو اومدم به پراسس اول name رو اختصاص دادم ولی به  اخری ندادم.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.101.jpeg)

**تعریف تابع**   :**myFunc** این تابع دو آرگومان میپذیرد sleep\_time :زمان خواب و   output\_list لیستی اشتراکی برای ذخیره خروجیها  

**دریافت نام فرآیند** :نام فرآیند جاری با استفاده از   multiprocessing.current\_process().name دریافت میشود.  

**ثبت پیام شروع** :یک رشته به نام  output\_str ایجاد شده و شامل پیام Starting" نام فرآیند" است. این پیام به output\_list اضافه میشود.  

**زمان خواب** :فرآیند برای مدتی که در   sleep\_time مشخص شده است، میخوابد.  

**ثبت پیام خروج** :پس از بیدار شدن، یک رشته جدید به نام  output\_str ایجاد شده و شامل پیام Exiting" نام فرآیند" است. این پیام نیز به   output\_list اضافه میشود.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.102.jpeg)

**ایجاد مدیر فرآیندها** :یک مدیر فرآیند (multiprocessing.Manager) ایجاد میشود که امکان اشتراک گذاری دادهها بین فرآیندها را فراهم میکند.  

**ایجاد لیست اشتراکی** :یک لیست اشتراکی (output\_list) با استفاده از مدیر فرآیند ساخته میشود که برای ذخیره خروجیهای فرآیندها استفاده میشود.  

`  `**تعریف و شروع فرآیند با نام مشخص** :یک فرآیند با نام   myFunc تعریف میشود که تابع   myFunc را با آرگومانهای  زمان خواب 3و  output\_list فراخوانی میکند. سپس این فرآیند شروع به کار میکند.  

`  `**تعریف و شروع فرآیند با نام پیشفرض** :یک فرآیند دیگر بدون نام مشخص تعریف میشود که تابع   myFunc را با 
آرگومانهای  زمان خواب 1و  output\_list فراخوانی میکند. سپس این فرآیند نیز شروع به کار میکند.  

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.103.png)

**سناریو دوم:** توی این سناریو اومدم به هر دو فرایند مقدار name رو داده ام .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.104.jpeg)

خروجی :  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.105.png)

**سناریو سوم**:اومدم توی این سناریو گفته ام هر کدوم از پراسس ها استارت بشن و پیام خروج رو چاپ کنن و همچنین یه فرایند دیگه اضافه کردم که مقدار name را نمی گیرد .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.106.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.107.png)

**تمرین سوم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.108.png)

**سناریو اول:** توی این سناریو اومدم مقدار دایمنت را برا هردو مقدار false قرار داده ام  که پرینت  برای دو پراسس عمل کند صورت کامل چاپ میشن .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.109.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.110.jpeg)

اومدم یه حلقه قرار دادم که مقدار اجرای خودش رو از پراسس ها میگیرد و چون از دایمنت استفاده کردم و ان را فالز هستش مقدار هر دو پراسس برای چاپ فرستاده میشه.  

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.111.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.112.png)

**سنار و دوم :** توی این سناریو اومدم مقدار دایمنت را برای برای اولی ترو کردم که مقدار های آن چاپ نشه .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.113.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.114.jpeg)

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.115.png)

**سناریو سوم:** توی این مقدار دایمنت را برای دومی ترو کرده ام که اجرا نشود.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.116.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.117.jpeg)

` `توی قسمت جوین اون : در اینجا، فرآیندهای غیر دایمون (که  daemon=Falseهستند) ب  آنها پیوسته میشود تا از اتمام کامل آنها مطمئن شوید. فرآیندهای دایمون (daemon=True) در این مرحله پیوسته نمیشوند و ممکن است پیش از پایان کار متوقف 

شوند.  

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.118.png)

**تمرین چهارم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.119.png)


**سناریو اول:توی** این سناریو دقیقا** همان خروجی که ازم خواسته شده رو انجام داده ام.  

این کد به ما اجازه میدهد تا وضعیتهای مختلف یک فرآیند را در طول عمر آن بررسی کنید، از شروع تا اتمام و پیوستن به آن، و به ما یک نمای کلی از نحوه کار فرآیندها را میدهد.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.120.jpeg)

`  `:foo تابع

این تابع پیامی مبنی بر شروع تابع چاپ میکند.سپس، درون یک حلقه  forاز 0 تا 9 بهطور متوالی، پیامهایی از جمله مقادیر شمارنده چاپ میکند و هر بار به مدت 1 ثانیه توقف میکند  .در پایان، پیامی مبنی بر پایان تابع چاپ میکند  

:get\_process\_info تابع

`  `این تابع یک رشته نمایشی از وضعیت یک شیء فرآیند (p) را برمیگرداند.  

`  `نمایشی از شناسه فرآیند (pid) و کد خروجی (exitcode) فرآیند را شامل میشود.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.121.jpeg)

- **before\_execution**

`  `(initial).نمایش وضعیت فرآیند قبل از شروع

- برای بررسی اینکه آیا فرآیند در حال حاضر زنده است یا خیر p.is\_alive() 
- **Running**

`  `(started).نمایش وضعیت فرآیند پس از شروع

بررسی اینکه آیا فرآیند هنوز زنده است.  

- **Terminated**

نمایش وضعیت فرآیند بعد از مدتی پس از شروع، پیش از ترمینیشن.  بررسی اینکه آیا فرآیند هنوز زنده است.  

- **Joined**

`  `(stopped[SIGTERM]).نمایش وضعیت فرآیند بعد از پیوستن

بررسی اینکه آیا فرآیند هنوز زنده است.  

- **exit\_code**

کد خروجی فرآیند پس از اتمام کار آن.  

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.122.png)

**سناریو دوم:**  توی این سناریو اومدم جوری اون رو طراحی کردم که اولی فاز باشد دومی ترو و سومی فالز را نمایش دهد و اخری هم فالز را نمایش دهد.یعنی بهش گفتم فرایند که استارت شد و زنده شد بیا اونو بلا فاصله ترمینیت کن خاتمه به ان بده .که خروجی 

متفاوت تولید می شود.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.123.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.124.png)

**سناریو سوم:** توی این خروجی اومدم مقدار pid رو هم اضافه کرده ام و name هم به آن اضافه کردم باستفاده از {p} این  .  {p}  را در قالب رشتهای چاپ میکنیم ، مثل multiprocessing.Process   توضیح: در پایتون، وقتی شیءای از کلاس

در یک قالب رشته، نمایشی از وضعیت شیء فرآیند به ما نمایش داده میشود. این نمایشی از اطلاعات داخلی شیء است که شامل نام(name) ، شناسه فرآیند(pid) ، و وضعیت فرآیند است.  

- چیه Pid

شناسه فرآیند PID یا Process ID در سیستمعاملهای مدرن برای شناسایی و مدیریت فرآیندها استفاده میشود PID .یک عدد منحصر به فرد است که به هر فرآیند در سیستمعامل اختصاص داده میشود و به سیستمعامل و سایر برنامهها کمک میکند تا بتوانند به طور 

دقیق فرآیندها را شناسایی کنند و با آنها تعامل داشته باشند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.125.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.126.png)

**تمرین پنجم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.127.png)

**سناریو اول:**توی این سناریو خروجی که ازم خواسته شده رو تولید کرده ام به صورت جیسون.  

توضیح: یک زیر کلاس از multi processing.process ایجاد می شود که برای اجرا به run اشاره میکند.تابع init را ما نداریم اینجا از init و ساب کلاس استفاده میکند ما اینجا فقط run رو داریم.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.128.jpeg)

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.129.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.130.png)

**سناریو دوم:** توی این سناریو اومدم خروجی رو معکوس کرده ام از بزرگ به کوچیک نمایش میده خروجی رو .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.131.jpeg)

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.132.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.133.png)

**سناریو سوم:** اومدم اول زوج هارو نمایش دادم بعد فرد هارو توی این سنارو .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.134.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.135.jpeg)

اومدم یه حلقه قرار دادم که اول زوج هارو بهم نمایش میده بعد فرد هارو.  **خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.136.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.137.png)

**تمرین ششم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.138.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.139.png)

**تمرین هفتم:**   

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.140.png)

**سناریو اول:**توی این سناریو من گفتم زمان دقیق که فرایند ها به مانع می رسن رو بهم بده دوتای اولی مانع دارن که زمان دقیق رو بهم میده و دوتای اخری که مانع ندارن مقدار barrier\_cross\_time ان هارو می اید فالز قرار میدهد یعنی مانعی برای ان ها وجود 

ندارد .  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.141.jpeg)

توی این تابع مال اونای هستش که مانع دارن فرایند های اول و دوم به این رجوع میکنن توی قسمت serializer گفتم که اجازه اجرای هم زمان ندارند به ترتیب اجرا شوند که توی بدنه آن اومدم barrier\_cross\_time  زمان ورود فرآیند به 

- **Barrier**می باشد .قسمت finish time هم زمان خاتمه فرایند است که چون خیلی نزدیکه برا فرایند ها یه تایم در نظر 

میگیره سیستم به صورت خودکار و has barrier هم ترو می باشد یعنی فرایند از بریر استفاده می کند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.142.png)

**این تابع برای اونای هستش که از مانع استفاده نمی کنند مواردی که برای مانع بود اینجا وجود ندارن.**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.143.jpeg)

**اینجا اومدم** (synchronizer = Barrier(2 رو روی دو فرایند قرار دادم چون فقط دو فرایند از مانع دارد استفاده می کند.**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.144.jpeg)

**این قسمت از کد برای جمع اوری نتایج می باشد که به ترتیب اونارو مرتب میکند**  

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.145.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.146.png)

` `p1 **سناریو دوم:** توی تین سناریو اومدم مانع رو برای دو فرایند اخری قرار دادم یعنی سه و چهار پس توی این سناریو فرایند های

وp2 هر چون مانع ندارند زود تر از فرایند p3وp4 خارج می شوند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.147.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.148.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.149.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.150.jpeg)

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.151.png)


![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.152.png)

**سناریو سوم:**توی این سناریو اومدم یه فرایند دیگه اضافه کردم که اونم از مانع استفاده میکنه الان دیگه سه فرایند از مانع استفاده می کنند.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.153.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.154.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.155.jpeg)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.156.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.157.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.158.png)

**تمرین ششم:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.159.png)

**سناریو اول:** توی این سناریو گفتم که رنج داده های ورودی بین  یک ت 100 باشه  بهش گفتم که داده های ورودی رو ضرب با هم کن result = data \* data و خروجیش به صورت جیسون در اینسمنیا نمایش داده شود.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.160.jpeg)

- یک استخر فرآیند با چهار فرآیند )پروسس( ایجاد میکند  **multiprocessing.Pool(processes=4)**

` `را به طور موازی بر روی تمام عناصرfunction\_square  تابع  **pool.map(function\_square, inputs)**

لیست  inputsاعمال میکند و نتایج را به صورت لیستی از خروجیها (pool\_outputs) برمیگرداند.   پس از انجام محاسبات، **استخر فرآیندها**  (Pool)به طور خودکار بسته میشود.

- لیستی از اعداد صحیح از 0 تا 99 ایجاد میکند  **inputs = list(range(0, 100))**

` `را فراخوانی میکند تا مربع تمامcalculate\_squares  تابع  **results = calculate\_squares(inputs)**

اعداد لیست  inputsرا به طور موازی محاسبه کند.  

` `به عنوان خروجیresults  نتایج محاسبه شده را در قالب دیکشنری با کلید  **return {"results": results}**

برمیگرداند.  

**خروجی:**  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.161.png)


![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.162.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.163.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.164.png)

**سناریو دوم:**توی این سناریو اومدم ورودی هارو به توان 3 رسوندم که خروجی متفاوت تولید کنه.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.165.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.166.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.167.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.168.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.169.png)

**سناریو سوم:** توی این سناریو اومدم تعداد یا رنج ورودی رو به 50 تغیر دادم و اومدم داده های ورودی با هم ضرب کردم دوباره جمعش کردم با همون ورودی اولیه که با این کار کلا اعداد نمایش داده شده در خروجی متفاوت میشن.  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.170.jpeg)

خروجی:  

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.171.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.172.png)

![](Aspose.Words.6b464f6e-da29-46bb-bdd4-6def853a0069.173.png)

